name: ğŸš€ Scraping Automatique Courir.com

on:
  schedule:
    - cron: '*/30 * * * *'  # â° Toutes les 30 minutes
  workflow_dispatch:         # ğŸ® DÃ©clenchement manuel

jobs:
  scrape:
    runs-on: ubuntu-latest   # ğŸ’» Machine virtuelle Ubuntu
    timeout-minutes: 20      # â±ï¸ Maximum 20 minutes d'exÃ©cution

    env:
      SUPABASE_URL: ${{ secrets.SUPABASE_URL }}
      SUPABASE_SERVICE_ROLE: ${{ secrets.SUPABASE_SERVICE_ROLE }}

    steps:
    # Ã‰tape 1: ğŸ“¥ TÃ©lÃ©charger le code
    - name: Checkout du code
      uses: actions/checkout@v4

    # Ã‰tape 2: ğŸ Installer Python
    - name: Installation de Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.10'

    # Ã‰tape 3: ğŸ“¦ Installer les dÃ©pendances
    - name: Installation des dÃ©pendances
      run: pip install -r scripts/requirements.txt

    # Ã‰tape 4: ğŸ•·ï¸ Lancer le scraping
    - name: ExÃ©cution du scraping
      run: |
        cd scripts
        python scraper.py
